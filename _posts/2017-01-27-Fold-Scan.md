---
layout: post
date: 2017-01-27
title: Haskell ä¸­çš„ foldlã€foldrã€scanlã€scanr
img: "haskell_fold_scan.jpg"
---

**fold** = åˆå§‹å€¼ + å‡½æ•° + List

å–ä¸€ä¸ªäºŒå…ƒå‡½æ•°ï¼Œä¸€ä¸ªåˆå§‹å€¼å’Œä¸€ä¸ªéœ€è¦æŠ˜å çš„ List åšå‚æ•°ï¼Œç”¨åˆå§‹å€¼ä¸Ž List ä¸­çš„å…ƒç´ åšå‡½æ•°æ“ä½œã€‚

foldl
---
---

{% highlight haskell %}
ghci>:t foldl
foldl :: Foldable t => (b -> a -> b) -> b -> t a -> b
{% endhighlight %}

*å·¦æŠ˜å * å®ƒä»Ž List çš„å·¦ç«¯å¼€å§‹æŠ˜å ï¼Œä¼ å…¥ä¸€ä¸ªåˆå§‹å€¼ï¼Œå¹¶ç”¨åˆå§‹å€¼é€ä¸ªä¸Ž List çš„å…ƒç´ å‘¼å«ç¬¬ä¸€ä¸ªå‡½æ•°å‚æ•°å¾—åˆ°ç´¯åŠ å€¼ã€‚

{% highlight haskell %}
ghci>foldl (+) 5 [1, 2, 3, 4]
15
-- å®ƒçš„æ‰§è¡Œè¿‡ç¨‹æ˜¯è¿™æ ·
-- 5 + 1 => 6
-- 6 + 2 => 8
-- 8 + 3 => 11
-- 11 + 4 => 15

ghci>foldl (+) 0 [1, 2]
3
{% endhighlight %}

> ç”¨ **foldl** é‡å†™ **sum** å‡½æ•°

**sum** æ˜¯å¯¹ List ä¸­çš„å…ƒç´ æ±‚å’Œçš„å‡½æ•°ï¼Œ[ä¹‹å‰çš„æ–‡ç« ](http://redtwowolf.github.io/2017/01/14/Haskell-And-Swift-Pattern-Match.html)ä¸­ä¹Ÿæœ‰å®žçŽ°è‡ªå·±çš„ *sum'* å‡½æ•°ï¼Œåœ¨è¿™é‡Œç”¨åŒ¿åå‡½æ•°å’Œ **foldl** æ¥é‡å†™å®ƒã€‚åœ¨ **test.hs** æ–‡ä»¶ä¸­åˆ›å»º *sum''* å‡½æ•°åƒè¿™æ ·ï¼š

{% highlight haskell %}
-- sum''
sum'' :: (Num a) => [a] -> a
sum'' xs = foldl (\acc x -> acc + x) 0 xs
{% endhighlight %}

ä¸º **foldl** å‡½æ•°ä¼ å…¥ä¸€ä¸ª *(\acc x -> acc + x)* çš„ç´¯åŠ å‡½æ•°ï¼Œè¿™å…¶å®žå’Œ *(+)* ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸Šè¿°ä¹Ÿå¯ä»¥æ”¹å†™ä¸ºä¸‹é¢è¿™æ ·ï¼š

{% highlight haskell %}
-- sum'''
sum''' :: (Num a) => [a] -> a
sum''' = foldl (+) 0
{% endhighlight %}
æ€Žä¹ˆæ˜¯è¿™æ ·ï¼ŸðŸ¤”ðŸ¤”ðŸ¤”ðŸ¤”ðŸ¤”ðŸ¤” æ€Žä¹ˆè¿žéœ€è¦ä¼ å…¥çš„ List éƒ½æ²¡æœ‰äº†ï¼Ÿåˆ«å¿˜äº†ä¸Šé¢åˆšåˆšè¯´è¿‡çš„ä¸å…¨å‘¼å«å‡½æ•°å“¦ï¼*foldl (+) 0* ä¼šå›žä¼ ä¸€ä¸ª *[a] -> a* çš„å‡½æ•°å“¦ï¼ðŸ˜ƒðŸ˜ƒðŸ˜ƒðŸ˜ƒðŸ˜ƒðŸ˜ƒðŸ˜ƒðŸ˜ƒðŸ˜ƒ æµ‹è¯•ä¸€ä¸‹ ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°ðŸŒ°

{% highlight haskell %}
ghci>sum
sum     sum'    sum''   sum'''

ghci>let test = [1, 2, 3, 4, 5]

ghci>sum test
15

ghci>sum' test
15

ghci>sum'' test
15

ghci>sum''' test
15
{% endhighlight %}

foldr
---
---

{% highlight haskell %}
ghci>:t foldr
foldr :: Foldable t => (a -> b -> b) -> b -> t a -> b
{% endhighlight %}

*å³æŠ˜å * ä¸Žå·¦æŠ˜å ä¸€æ ·ï¼Œåªæ˜¯ä»Žå³è¾¹å¼€å§‹è€Œå·²ã€‚

{% highlight haskell %}ghci>
ghci>foldr (+) 5 [1, 2, 3, 4]
15
-- å®ƒçš„æ‰§è¡Œè¿‡ç¨‹æ˜¯è¿™æ ·
-- 4 + 5 => 9
-- 9 + 3 => 12
-- 12 + 2 => 14
-- 14 + 1 => 15
{% endhighlight %}

> **foldr** å®žçŽ° **map**

åœ¨ **test.hs** ä¸­å£°æ˜Žä¸€ä¸ª *map'* çš„å‡½æ•°ï¼Œå®ƒä¸Ž **map** æ˜¯å…„å¼ŸðŸ˜‚ðŸ˜‚ðŸ˜‚ðŸ˜‚ðŸ˜‚

{% highlight haskell %}
-- map'
map' :: (a -> b) -> [a] -> [b]
map' f xs = foldr (\x acc -> f x:acc) [] xs
{% endhighlight %}

æ¯”å¦‚å¯¹ä¸€ä¸ª List ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½åŠ  5 çš„å®žçŽ°ã€‚

{% highlight haskell %}
ghci>map' (+5) [1, 2, 3]
[6,7,8]
{% endhighlight %}



foldl1
---
---

{% highlight haskell %}
ghci>:t foldl1
foldl1 :: Foldable t => (a -> a -> a) -> t a -> a
{% endhighlight %}

ä¸Ž **foldl** ä¹Ÿå·®ä¸å¤šï¼Œåªæ˜¯ä¸éœ€è¦æä¾›ä¸€ä¸ªåˆå§‹å€¼ï¼Œå®ƒè‡ªåŠ¨å– List çš„ head ä½œä¸ºåˆå§‹å€¼ï¼Œå¹¶ä»Ž List çš„ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹æŠ˜å ã€‚

{% highlight haskell %}
-- åº”è¯¥æ˜¯ 6
ghci>foldl1 (+) [1, 2, 3]
6

ghci>foldl1 (+) [2, 2, 3]
7
-- åº”è¯¥æ˜¯ 13
ghci>foldl1 (+) [8, 2, 3]
13
{% endhighlight %}

foldr1
---
---

ä¸Ž  **foldl1** å·®ä¸å¤šï¼Œä¹Ÿä¸éœ€è¦æä¾›åˆå§‹å€¼ï¼Œå®ƒå–æœ€åŽä¸€ä¸ªå…ƒç´ ä½œä¸ºåˆå§‹å€¼ï¼Œå¹¶ä»Ž List çš„å€’æ•°äºŒä¸ªå…ƒç´ å¼€å§‹æŠ˜å ã€‚

{% highlight haskell %}
ghci>foldr1 (+) [1, 2, 3, 4]
10
-- å®ƒæ˜¯æ€Žä¹ˆæ‰§è¡Œçš„ï¼Ÿ
-- åˆå§‹å€¼æ˜¯ 4
-- 3 + 4 => 7
-- 2 + 7 => 9
-- 1 + 9 => 10

ghci>foldr1 (-) [1, 2, 3, 4]
-2
-- ðŸ˜²ðŸ˜²ðŸ˜²ðŸ˜²ðŸ˜² -2
-- å®ƒåˆæ˜¯å’‹æžçš„ï¼Ÿ
-- åˆå§‹å€¼ 4ï¼Œç„¶åŽä»Žå€’æ•°ç¬¬äºŒå¼€å§‹æŠ˜å 
-- 3 - 4 => -1
-- 2 - (-1) => 3
-- 1 - 3 => -2
-- ðŸ˜¸ðŸ˜¸ðŸ˜¸ðŸ˜¸ðŸ˜¸ðŸ˜¸
{% endhighlight %}

è¿™å¼ å›¾èƒ½è®©ä½ çœ‹çš„æ›´æ¸…æ¥š
![](http://ogkg37m8j.bkt.clouddn.com/image/jpg/swiftrecursion/foldlr.jpg)

scanl
---
---

**scanl** ä¸Ž **foldl** ä¸€æ ·éƒ½æ˜¯ä»Žå·¦æŠ˜å ã€‚**foldl** è®°å½•åˆå§‹å€¼ä¸Ž List ä¸­æ¯ä¸ªå…ƒç´ ä½œç”¨åŽçš„ç´¯åŠ å€¼ï¼Œè€Œ **scanl** è®°å½•åˆå§‹å€¼ä¸Žæ¯ä¸ªå…ƒç´ ä½œç”¨åŽçš„æ‰€æœ‰ç´¯åŠ å€¼ã€‚

{% highlight haskell %}
ghci>scanl (+) 1 [1, 2, 3, 4]
[1,2,4,7,11]

ghci>scanl (-) 1 [1, 2, 3, 4]
[1,0,-2,-5,-9]
-- å®ƒæ˜¯æ€Žä¹ˆå·¥ä½œçš„ï¼Ÿ
-- åˆå§‹å€¼ 1 ä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªç´¯åŠ å€¼
-- 1 - 1 => 0
-- 0 - 2 => -2
-- -2 - 3 => -5
-- -5 - 4 => -9
{% endhighlight %}

scanr
---
---

**scanr** ä¸Ž **scanl** åŠŸèƒ½ä¸€æ ·ï¼Œé¡ºåºç›¸åã€‚

{% highlight haskell %}
ghci>scanr (+) 1 [1, 2, 3, 4]
[11,10,8,5,1]

ghci>scanr (-) 1 [1, 2, 3, 4]
[-1,2,0,3,1]
-- å®ƒæ˜¯æ€Žä¹ˆæžçš„å‘¢ï¼ŸðŸ¤•ðŸ¤•ðŸ¤•ðŸ¤•ðŸ¤•
-- åˆå§‹å€¼ 1 => 1
-- 4 - 1 => 3
-- 3 - 3 => 0
-- 2 - 0 => 2
-- 1 - 2 = > -1
{% endhighlight %}

scanl1
---
---

**scanl1** ä¸Ž **foldl1** ç›¸ä¼¼ï¼Œä¹Ÿä¸Ž **scanl** ç›¸ä¼¼ã€‚what? çœ‹å‘¢å°±æ˜Žç™½Â·Â·Â·Â·Â·Â·

{% highlight haskell %}
ghci>scanl1 (+) [1, 2, 3, 4]
[1,3,6,10]

ghci>scanl1 (-) [1, 2, 3, 4]
[1,-1,-4,-8]
-- å– List çš„å¤´éƒ¨ä½œä¸ºåˆå§‹å€¼ => 1
-- 1 - 2 => -1
-- -1 - 3 => -4
-- -4 - 4 = > -8
-- æ˜¯ä¸æ˜¯å’Œ foldl1 ç›¸ä¼¼ï¼Œä¹Ÿå’Œ scanl ç›¸ä¼¼ðŸ˜¸ðŸ˜¸ðŸ˜¸ðŸ˜¸ðŸ˜¸
{% endhighlight %}


scanr1
---
---

**scanr1** ä¸Ž **scanl1** åŠŸèƒ½ä¸€æ ·ï¼Œé¡ºåºç›¸åã€‚

{% highlight haskell %}
ghci>scanr1 (+) [1, 2, 3, 4]
[10,9,7,4]

ghci>scanr1 (-) [1, 2, 3, 4]
[-2,3,-1,4]
-- åˆå§‹å€¼ 4 => 4
-- 3 - 4 => -1
-- 2 - (-1) => 3
-- 1 - 3 => -2
{% endhighlight %}

ä¸€å¼ å›¾çœ‹æ¸… **scan + l/r**
![](http://ogkg37m8j.bkt.clouddn.com/image/jpg/haskellandswift/function/scanlr.jpg)
