---
layout: post
date: 2016-12-29
title: Runtime
feature-img: "img/blue.jpg"

---

<h2>一、 Runtime简介</h2>
---
Objective-C是一门动态语言，所以除了需要编译器之外，还需要一个运行时系统（runtime system），目的是将一些工作从编译环节推迟到运行时。Runtime简称运行时。
[更过关于Runtime的介绍](https://developer.apple.com/reference/objectivec/1657527-objective_c_runtime)

<h2>二、 认识Runtime</h2>
---
要认识Runtime就要从Runtime相关的头文件说起，在[这里](https://opensource.apple.com/source/objc4/objc4-217/runtime/)可以下载到runtime相关的头文件，也可以在👇路径找得到
{% highlight ruby %}
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/include/objc
{% endhighlight %}
看起来像这样

![runtime](http://ogkg37m8j.bkt.clouddn.com/image/runtime/runtime.jpg)

其中最重要的就是runtime.h和message.h 。下面分别说明
<h3>1. runtime.h</h3>
{% highlight swift %}
#ifndef _OBJC_RUNTIME_H
#define _OBJC_RUNTIME_H

#include <objc/objc.h>
#include <stdarg.h>
#include <stdint.h>
#include <stddef.h>
#include <Availability.h>
#include <TargetConditionals.h>

#if TARGET_OS_MAC
#include <sys/types.h>
#endif
{% endhighlight %}
这是runtime.h文件的第一部分，引入了一些其他头文件，这里简单说面一下 **ifndef** ，它是 **if not defined** 的简写，目的是保证同一个文件不会被包含多次。接下来的第二部分定义了一些类型
{% highlight swift %}/* Types */

#if !OBJC_TYPES_DEFINED

/// An opaque type that represents a method in a class definition.
typedef struct objc_method *Method;

/// An opaque type that represents an instance variable.
typedef struct objc_ivar *Ivar;

/// An opaque type that represents a category.
typedef struct objc_category *Category;

/// An opaque type that represents an Objective-C declared property.
typedef struct objc_property *objc_property_t;

struct objc_class {
    Class isa  OBJC_ISA_AVAILABILITY;

#if !__OBJC2__
    Class super_class                                        OBJC2_UNAVAILABLE;
    const char *name                                         OBJC2_UNAVAILABLE;
    long version                                             OBJC2_UNAVAILABLE;
    long info                                                OBJC2_UNAVAILABLE;
    long instance_size                                       OBJC2_UNAVAILABLE;
    struct objc_ivar_list *ivars                             OBJC2_UNAVAILABLE;
    struct objc_method_list **methodLists                    OBJC2_UNAVAILABLE;
    struct objc_cache *cache                                 OBJC2_UNAVAILABLE;
    struct objc_protocol_list *protocols                     OBJC2_UNAVAILABLE;
#endif

} OBJC2_UNAVAILABLE;
/* Use `Class` instead of `struct objc_class *` */
#endif
{% endhighlight %}
在这一部分需要说明的有两个部分，一是 **typedef struct objc_method *Method** ，二是 **OBJC2_UNAVAILABLE** 。
**typedef struct objc_method *Method** 定义了一个 **Method** 的类型

<h3>2. message.h</h3>
