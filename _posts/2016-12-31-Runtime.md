---
layout: post
date: 2016-12-29
title: Runtime
feature-img: "img/blue.jpg"

---

<h2>ä¸€ã€ Runtimeç®€ä»‹</h2>
---
Objective-Cæ˜¯ä¸€é—¨åŠ¨æ€è¯­è¨€ï¼Œæ‰€ä»¥é™¤äº†éœ€è¦ç¼–è¯‘å™¨ä¹‹å¤–ï¼Œè¿˜éœ€è¦ä¸€ä¸ªè¿è¡Œæ—¶ç³»ç»Ÿï¼ˆruntime systemï¼‰ï¼Œç›®çš„æ˜¯å°†ä¸€äº›å·¥ä½œä»ç¼–è¯‘ç¯èŠ‚æ¨è¿Ÿåˆ°è¿è¡Œæ—¶ã€‚Runtimeç®€ç§°è¿è¡Œæ—¶ã€‚
[æ›´è¿‡å…³äºRuntimeçš„ä»‹ç»](https://developer.apple.com/reference/objectivec/1657527-objective_c_runtime)

<h2>äºŒã€ è®¤è¯†Runtime</h2>
---
è¦è®¤è¯†Runtimeå°±è¦ä»Runtimeç›¸å…³çš„å¤´æ–‡ä»¶è¯´èµ·ï¼Œåœ¨[è¿™é‡Œ](https://opensource.apple.com/source/objc4/objc4-217/runtime/)å¯ä»¥ä¸‹è½½åˆ°runtimeç›¸å…³çš„å¤´æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åœ¨ğŸ‘‡è·¯å¾„æ‰¾å¾—åˆ°
{% highlight ruby %}
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/include/objc
{% endhighlight %}
çœ‹èµ·æ¥åƒè¿™æ ·

![runtime](http://ogkg37m8j.bkt.clouddn.com/image/runtime/runtime.jpg)

å…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯runtime.hå’Œmessage.h ã€‚ä¸‹é¢åˆ†åˆ«è¯´æ˜
<h3>1. runtime.h</h3>
{% highlight swift %}
#ifndef _OBJC_RUNTIME_H
#define _OBJC_RUNTIME_H

#include <objc/objc.h>
#include <stdarg.h>
#include <stdint.h>
#include <stddef.h>
#include <Availability.h>
#include <TargetConditionals.h>

#if TARGET_OS_MAC
#include <sys/types.h>
#endif
{% endhighlight %}
è¿™æ˜¯runtime.hæ–‡ä»¶çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œå¼•å…¥äº†ä¸€äº›å…¶ä»–å¤´æ–‡ä»¶ï¼Œè¿™é‡Œç®€å•è¯´é¢ä¸€ä¸‹ **ifndef** ï¼Œå®ƒæ˜¯ **if not defined** çš„ç®€å†™ï¼Œç›®çš„æ˜¯ä¿è¯åŒä¸€ä¸ªæ–‡ä»¶ä¸ä¼šè¢«åŒ…å«å¤šæ¬¡ã€‚æ¥ä¸‹æ¥çš„ç¬¬äºŒéƒ¨åˆ†å®šä¹‰äº†ä¸€äº›ç±»å‹
{% highlight swift %}/* Types */

#if !OBJC_TYPES_DEFINED

/// An opaque type that represents a method in a class definition.
typedef struct objc_method *Method;

/// An opaque type that represents an instance variable.
typedef struct objc_ivar *Ivar;

/// An opaque type that represents a category.
typedef struct objc_category *Category;

/// An opaque type that represents an Objective-C declared property.
typedef struct objc_property *objc_property_t;

struct objc_class {
    Class isa  OBJC_ISA_AVAILABILITY;

#if !__OBJC2__
    Class super_class                                        OBJC2_UNAVAILABLE;
    const char *name                                         OBJC2_UNAVAILABLE;
    long version                                             OBJC2_UNAVAILABLE;
    long info                                                OBJC2_UNAVAILABLE;
    long instance_size                                       OBJC2_UNAVAILABLE;
    struct objc_ivar_list *ivars                             OBJC2_UNAVAILABLE;
    struct objc_method_list **methodLists                    OBJC2_UNAVAILABLE;
    struct objc_cache *cache                                 OBJC2_UNAVAILABLE;
    struct objc_protocol_list *protocols                     OBJC2_UNAVAILABLE;
#endif

} OBJC2_UNAVAILABLE;
/* Use `Class` instead of `struct objc_class *` */
#endif
{% endhighlight %}
åœ¨è¿™ä¸€éƒ¨åˆ†éœ€è¦è¯´æ˜çš„æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€æ˜¯ **typedef struct objc_method *Method** ï¼ŒäºŒæ˜¯ **OBJC2_UNAVAILABLE** ã€‚
**typedef struct objc_method *Method** å®šä¹‰äº†ä¸€ä¸ª **Method** çš„ç±»å‹

<h3>2. message.h</h3>
